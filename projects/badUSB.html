<!DOCTYPE HTML>
<html>
	<head>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
		<link rel="stylesheet" href="/portfolio/style.css">
		<link rel="stylesheet" href="project.css">
		<title>BadUSB</title>
	</head>
	<body>
		<div id="navigation"></div>
		<header>BadUSB</header>
		
		<div class="container-xl">
			<div class="row pt-2">
				<h1 id="description">Description</h1>
				<p>
					A BadUSB is a device that emulates a keyboard which runs a pre-programmed set of key presses to perform a task. This can be used for penetration testing or repetitive administration tasks.<br  />
					This project was created to give me an understanding on designing printed circuit boards (PCBs) and how to work with microcontrollers directly, instead of using development boards such as Arduinos. This gives flexibility and allows for more complex future projects.<br  />
					It uses a microcontroller, the ATmega32u4, which emulates a keyboard and mouse to perform tasks. The task can be chosen by first programming which keys to be pressed then uploading it to the board.
				</p>
			</div>
			
			<div class="row pt-3">
				<h1 id="skills">Skills</h1>
				<ul>
					<li>Designing circuits and PCBs</li>
					<li>Working with and designing circuits for microchips</li>
					<li>Creating small form factor electronics</li>
					<li>Soldering surface mount components</li>
				</ul>
			</div>
			
			<div class="row pt-3">
				<h1 id="features">Closer look</h1>
				<p>
					<img class="main-picture" src="/portfolio/img/badusb/case open.jpg" /><br  />
					The main design considerations for the printed circuit board is the small form factor, to make it look like other USB thumb drives.<br  />
					To achieve this goal I needed to use SMD parts which can be very small and only take up one side of the board, compared to the larger through hole devices.<br  />
					A downside for these components is some of them can be hard to solder without bridging the connections.<br  />
					The most important and intricate part of the PCB is the microcontroller, the ATmega32u4, and its required circuit.<br  />
					The microcontroller is then connected to the USB (supplying power and data connections) and to the input and outputs of the board.
				</p>
				<p>
					The code is written in C/C++ and uses the Arduino libraries to emulate the keyboard, the code is automatically ran when the device is plugged in.<br  />
					I have written a template code which sets up the virtual keyboard, lights, etc so all the user has to do is code the task using functions that I have made.<br  />
					Using this template I have written some examples, including one where a backup for a folder is created.
				</p>
				<p>
					The board has switches built in to them, allowing for the user to choose between multiple programs.<br  />
					There are also lights which show if there is an error or shows when the program is running or finished.<br  />
					The switches and lights are programmable so can be used for other purposes too.
				</p>
				<p>
					On the end of the board are 12 pins, plus seven pads on the underside, which can be used as general purpose input/output (I/O) pins.<br  />
					This gives the board more functionality as it can be used as a normal Arduino or connect more devices to it.
				</p>
				<p>
					<img class="main-picture" src="/portfolio/img/badusb/case.jpg" /><br  />
					The device sits inside a 3D printed case to give it a layer of protection and makes the BadUSB looks professional while maintaining usability.
				</p>
			</div>
			
			<div class="row pt-3">
				<h1 id="creating">Creating the Project</h1>
				<h3>Version 1</h3>
				<p>
					This was my first PCB design, so I had to learn how to convert circuit schematics into a functioning PCB.<br  />
					It was a test PCB and improvements were expected to be found when making and testing this design.<br  />
					This is a sketch that I used to help plan the schematic and layout:<br  />
					<img class="main-picture" src="/portfolio/img/badusb/plan.jpg" /><br  />
					I started with the main component, the ATmega32u4, which requires multiple passive components to function properly.<br  />
					Then I added the USB which gives the device power and data connections to the board. It was placed next to the microcontroller so the data lines would not have interference from other components or traces.<br  />
					The rest of the components could be placed almost anywhere so were placed on the other side of the microcontroller.<br  />
					<br  />
					Schematic:<br  />
					<img class="main-picture" src="/portfolio/img/badusb/v1 schematic.jpg" /><br  />
					The soldered PCB:<br  />
					<img class="side-picture" src="/portfolio/img/badusb/v1 top.jpg" />
					<img class="side-picture" src="/portfolio/img/badusb/v1 bottom.jpg" /><br  />
					<br  />
					This version had reliability issues but managed to function enough to validate the concept. There were some other issues such as inconsistent component sizes, for example having a small oscillator with very large capacitors.
				</p>
				<h3>Version 2</h3>
				<p>
					Using what I learned from making my first PCB I was able to improve on the board. This new version fixed the issues from the previous version while maintaining and improving functionality while keeping the same footprint.<br  />
					In order to improve the reliability of the device I looked for other circuits that used the ATmega32u4. I found the Teensy 2.0 which has a simpler and more robust circuit so I decided to use the mandatory components in my design.<br  />
					Test points were added to help troubleshooting and the number of I/O pins were doubled to allow for expandability.<br  />
					The board has more efficient component placement and I chose sensible component sizes.<br  />
					Lastly I improved the silkscreen for better readability when soldering and using the device, and changed the PCB colour from green to black for a more professional look.<br  />
					<br  />
					Schematic:<br  />
					<img class="main-picture" src="/portfolio/img/badusb/v2 schematic.jpg" /><br  />
					The soldered PCB:<br  />
					<img class="side-picture" src="/portfolio/img/badusb/v2 top.jpg" />
					<img class="side-picture" src="/portfolio/img/badusb/v2 bottom.jpg" /><br  />
					<br  />
					I was pleased with this design as it met the design goals while still managing to have features, such as the I/O pins, for it to be used beyond its intended purpose.
				</p>
			</div>
			
			<div class="row pt-3">
				<h1 id="future">Looking forward</h1>
				<ul>
					<li>I could expand on the idea of this USB platform, for example utilising storage in future devices.</li>
					<li>I now have the knowledge of how to use PCBs for future projects, and know what to learn for better and more complex designs.</li>
				</ul>
			</div>
			
			<div class="row pt-3">
				<h1 id="files">Files and Links</h1>
				<a href="https://github.com/MSchmidt951/Bad-USB">GitHub repository</a>
			</div>
		</div>
		
		<footer></footer>

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
		<script src="/portfolio/navbar.js"></script>
	</body>
</html>